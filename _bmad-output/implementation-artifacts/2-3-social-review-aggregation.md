# Story 2.3: 社交媒体评价聚合（重点城市）（Phase 2）

Status: backlog

## Story

As a 用户,
I want 在城市详情里看到来自社交媒体的真实评价（可跳转原文）,
so that 我可以用真实体验补足数据指标无法覆盖的感受与风险。

## Acceptance Criteria

1. 入口可见：城市详情中存在 `社交评价` Tab（或独立模块）。
2. 重点城市支持：至少对 5-10 个“重点城市”可展示评价内容。
3. 渠道覆盖（最小要求）：至少支持其中 2 个渠道：
   - 小红书（笔记）
   - 微博（讨论）
   - 知乎（问答）
4. 展示字段：每条内容至少包含标题/摘要、来源平台、发布时间（或抓取时间）、原文链接。
5. 数据可追溯：对每条内容，开发者能定位到其抓取来源与抓取时间（日志或 DB 字段）。
6. 合规与风险提示：
   - 明确“仅聚合公开内容 + 跳转原文”的产品策略。
   - 对爬虫/抓取行为在实现层做低频与可控（避免高频抓取）。

## Tasks / Subtasks

- [ ] Task 1：确定“重点城市”范围与更新频率（AC: 2）
  - [ ] 先做白名单（cityId 列表），避免全量城市造成抓取成本与风险。

- [ ] Task 2：确定数据获取方式（AC: 3-6）
  - [ ] 最小可行方案（推荐先做）：手动收集 + 定期更新（写入 DB/JSON）。
  - [ ] 进阶方案：低频爬虫（每周/月更新），并增加失败重试与限流。

- [ ] Task 3：数据结构与存储（AC: 4-5）
  - [ ] 设计统一的 `SocialPost`/`SocialMention` 结构：
    - [ ] `cityId`
    - [ ] `platform`
    - [ ] `title`
    - [ ] `summary`
    - [ ] `url`
    - [ ] `publishedAt`/`fetchedAt`
    - [ ] （可选）`coverImage`、`likeCount` 等

- [ ] Task 4：聚合 API（AC: 1, 4）
  - [ ] `GET /api/social?city=...` 返回结构化列表
  - [ ] 支持按平台过滤（可选）

- [ ] Task 5：前端展示（AC: 1-4）
  - [ ] Tab 切换（按平台）
  - [ ] 列表卡片展示 + 外链跳转
  - [ ] 空态与错误态兜底

- [ ] Task 6：最小自测记录（AC: 1-6）
  - [ ] 截图：社交评价 tab
  - [ ] 截图：2 个平台内容展示

## Dev Notes

### 合规与产品策略

- PRD 提到多种数据来源，但实际实现需要评估平台规则与法律风险。
- 建议 Phase 2 先以“人工可控”的方式落地：手动维护重点城市的代表性内容（可解释、可追溯）。

### References

- [Source: docs/prd/prd-product.md#功能4: 社交媒体评价聚合]

## Dev Agent Record

### Agent Model Used

Cascade
