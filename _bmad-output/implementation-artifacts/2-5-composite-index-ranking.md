# Story 2.5: 综合指数/综合排名（可解释、可配置）（Phase 2）

Status: backlog

## Story

As a 用户,
I want 看到一个“综合躺平指数/综合排序”，并能理解其组成与权重,
so that 我可以用一个更快的方式粗筛城市，同时不被黑盒评分误导。

## Acceptance Criteria

1. 有综合分：对城市列表生成一个 `composite_score`（或等价字段），并可按该分数排序。
2. 可解释：在详情页或说明弹窗里，清楚展示：
   - 参与计算的维度
   - 每个维度的权重
   - 维度如何归一化/缺失值如何处理
3. 可配置（最小可用）：权重可通过配置文件或环境变量调整（无需改代码发布也可以接受）。
4. 缺失字段不崩溃：某维度数据缺失时，有明确策略（跳过/默认值/降权），并在解释中体现。
5. 不替代分维度展示：综合分只能作为辅助入口；分维度信息仍是主信息。

## Tasks / Subtasks

- [ ] Task 1：定义综合分方法（AC: 1-2）
  - [ ] 选择候选维度（示例）：生活成本、气候舒适、交通可达、医疗资源、绿化/环境等。
  - [ ] 为每个维度定义：
    - [ ] 数据字段来源（来自 `GET /api/cities` 的哪个 key）
    - [ ] 归一化方式（min-max / z-score / 分桶）
    - [ ] 正向/反向指标（例如房价越低越好）

- [ ] Task 2：实现服务端计算（AC: 1, 4）
  - [ ] 计算 composite_score 并输出到接口结果中（可为新接口或扩展现有接口）。
  - [ ] 避免把计算逻辑放在前端（便于统一口径）。

- [ ] Task 3：实现解释视图（AC: 2, 5）
  - [ ] UI 展示权重与公式解释
  - [ ] 对缺失值策略进行展示

- [ ] Task 4：实现配置（AC: 3）
  - [ ] 权重配置来源：配置文件/环境变量
  - [ ] 有默认权重（可在文档中说明）

- [ ] Task 5：最小自测记录（AC: 1-5）
  - [ ] 截图：综合排序列表
  - [ ] 截图：综合分解释弹窗/区域

## Dev Notes

### 风险提示

- Phase 2 才引入综合分，避免与 MVP 口径冲突。
- 综合分的“可解释性”比数值本身更重要，否则容易引发信任问题。

### References

- [Source: docs/prd/prd-product.md#明确不做 (MVP不包含)]
- [Source: docs/prd/prd-product.md#说明：综合指数/排名在 Phase 2 迭代]

## Dev Agent Record

### Agent Model Used

Cascade
